@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent layout thrashing when scrollbar appears/disappears */
html {
    scrollbar-gutter: stable;
}

.dragging {
    opacity: 0.4;
    background: #1f2937; /* gray-800 */
}
.drag-over-placeholder {
    height: 50px;
    background: #374151; /* gray-700 */
    border: 2px dashed #6b7280; /* gray-500 */
    border-radius: 0.5rem; /* rounded-lg */
    margin: 0.5rem 0; /* Adjusted margin */
}

/* Dimmed effect for expanded stack */
.dimmed-stack > div:first-child {
    opacity: 0.4;
    filter: grayscale(0.5) blur(0.5px);
    transition: all 0.5s ease;
}

/* Animation for stack expansion */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.animate-fadeIn {
  animation: fadeIn 0.3s ease-out forwards;
}

/* New Selection Control */
.selection-control-check {
    transition: transform 0.2s ease-in-out;
}
.selection-control-bg:not(.selected) .selection-control-check {
    transform: scale(0);
}
.selection-control-bg.selected .selection-control-check {
    transform: scale(1);
}

@keyframes fade-out {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.95); }
}
.animate-hide {
  animation: fade-out 0.4s ease-out forwards;
}

/* Styles for inline expanded groups with animation */
.expanded-group-wrapper {
    display: grid;
    grid-template-rows: 0fr;
    overflow: hidden;
    /* CLOSING PHASE 2: Height shrinks (Wait 0.7s for width to close first) */
    transition: grid-template-rows 0.7s ease-in-out 0.7s; 
}

.expanded-group-wrapper.expanded {
    /* OPENING PHASE 1: Height grows immediately */
    grid-template-rows: 1fr;
    transition: grid-template-rows 0.7s ease-in-out 0s;
}

.expanded-group-container {
    overflow: hidden;
    min-height: 0; /* Important for grid to work properly */
}

.expanded-group-content {
    @apply bg-gray-800 rounded-lg border border-gray-700/50;
    width: 100%;
    min-height: fit-content;
    margin: 0 auto;
    
    /* CLOSED STATE (Start/End) */
    margin-top: 0;
    margin-bottom: 0;
    padding: 0 1rem;
    /* Narrow clip-path for tab effect */
    clip-path: inset(0 45% 0 45%); 
    opacity: 0;
    
    /* CLOSING PHASE 1: Width/Opacity shrink immediately */
    transition: 
        clip-path 0.7s ease-in-out 0s,
        margin 0.7s ease-in-out 0s,
        padding 0.7s ease-in-out 0s,
        opacity 0.7s ease-in-out 0s;
}

.expanded-group-wrapper.expanded .expanded-group-content {
    /* OPEN STATE */
    clip-path: inset(0 0 0 0);
    margin-top: 0.5rem; /* mt-2 */
    margin-bottom: 1.5rem; /* mb-6 */
    padding: 1rem; /* p-4 */
    opacity: 1;

    /* OPENING PHASE 2: Width/Opacity grow (Wait 0.7s for height) */
    transition: 
        clip-path 0.7s ease-in-out 0.7s,
        margin 0.7s ease-in-out 0.7s,
        padding 0.7s ease-in-out 0.7s,
        opacity 0.7s ease-in-out 0.7s;
}

/* Content Fade In (Inner Wrapper) */
.expanded-group-grid-wrapper {
    opacity: 0;
    transition: opacity 0.3s ease-out 0s;
}

.expanded-group-wrapper.expanded .expanded-group-grid-wrapper {
    opacity: 1;
    /* Wait for everything else */
    transition: opacity 0.7s ease-out 1s; 
}


/* Styles for "smart frames" in viewers */
.smart-frame {
    @apply absolute inset-0 rounded-lg pointer-events-none transition-all duration-300;
    content: '';
    box-shadow: 0 0 0 2px transparent inset;
}
.smart-frame.in-group {
    @apply shadow-gray-500/50;
    box-shadow: 0 0 0 2px rgba(107, 114, 128, 0.5) inset; /* gray-500 */
}
.smart-frame.selected {
    @apply shadow-green-500/80;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.8) inset; /* green-500 */
}

/* Vignette effect for unselected photos in a group */
.vignette-overlay {
    --vignette-intensity: 70%; /* Tune this value in inspector */
    @apply absolute inset-0 rounded-lg pointer-events-none;
    background: radial-gradient(ellipse at center, transparent 40%, black var(--vignette-intensity));
    opacity: 0.6;
}

/* Confirmation Modal Animation */
.confirmation-modal-content {
    transition: all 0.2s ease-out;
}
.confirmation-modal-enter .confirmation-modal-content {
    opacity: 0;
    transform: scale(0.95) translateY(10px);
}
.confirmation-modal-enter-active .confirmation-modal-content {
    opacity: 1;
    transform: scale(1) translateY(0);
}
.confirmation-modal-exit .confirmation-modal-content {
    opacity: 1;
    transform: scale(1) translateY(0);
}
.confirmation-modal-exit-active .confirmation-modal-content {
    opacity: 0;
    transform: scale(0.95) translateY(10px);
}
.col-span-all {
    column-span: all;
}